<nav ui-view="platforms" id="addSite" class="navmenu navmenu-default navmenu-fixed-right offcanvas">
</nav>

<div class="container">
  <div class="row header">
    <div class="col-xs-1">
      <img src="images/kalabox-blue.svg" alt="Really good looking logo of Kalabox" />
    </div>
    <div class="col-xs-8">
      <form class="form-inline">
        <div class="form-group">
          <label class="sr-only" for="siteSearch">Site search</label>
          <input type="search" ng-model="siteSearch" class="form-control" id="siteSearch" placeholder="Filter by site name">
        </div>
      </form>
    </div>
    <div class="col-xs-3">
      <a href="" class="btn btn-primary" data-toggle="offcanvas" data-target="#addSite">Add Site</a>
    </div>
  </div>
  engine: {{ui.engineStatus}}
  <div ng-repeat="job in ui.jobs">
    <div>
      {{job.desc}} - ({{job.status}}) - {{job.err.message}} {{job.err.stack}} {{job.statusMsg}}
      - <button ng-disabled="job.status === 'running'" job-clear>clear</button>
      - <button ng-disabled="job.status !== 'failed'" job-retry>retry</button>
    </div>
  </div>
  <div class="sites row">
    <div ng-repeat="site in ui.sites | filter:siteSearch" ng-controller="SiteCtrl">
      <div class="site-wrapper col-xs-6">
        <div class="site" ng-class="siteClasses()">
          <div class="row image">
            <a ng-href="" site-browser><img class="col-xs-12 img-responsive" alt="Snapshot of your site"  ng-src="{{site.image}}"/></a>
          </div>
          <div class="row">
            <div class="site-info col-xs-12">
              <h3 ng-bind="site.name"></h3>
              <div class="site-actions">
                <a ng-href="" site-toggle class="btn btn-default site-power" ng-class="{'site-up': ui.states[site.name]}"><i class="fa fa-power-off fa-2"></i><span> Start</span></a>
                <div class="btn-group dropdown" uib-dropdown auto-close="outsideClick">
                  <div class="btn btn-default site-actions-dropdown" uib-dropdown-toggle>
                    <i class="fa fa-cog fa-2"></i>
                    <span> Actions</span>
                  </div>
                  <ul uib-dropdown-menu>
                    <li><a ng-href="" site-code><i class="fa fa-desktop fa-2"></i> <span>View</span></a></li>
                    <li><a ng-href="" site-pull><i class="fa fa-cloud-download fa-2"></i> <span>Pull</span></a></li>
                    <li><a ng-href="" site-push><i class="fa fa-cloud-upload fa-2"></i> <span>Push</span></a></li>
                    <li><a ng-href="" site-trash><i class="fa fa-trash-o fa-2"></i> <span>Delete</span></a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div ng-if="site.currentAction == 'start' || site.currentAction == 'stop'" class="clouds">
            <h2 class="loading" ng-bind="currentActionName()"></h2>
            <i id="cloud-light" class="cloud"></i>
            <i id="cloud-white" class="cloud"></i>
            <i id="cloud-gray" class="cloud"></i>
            <i id="cloud-dark" class="cloud"></i>
            <i id="cloud-front" class="cloud"></i>
          </div>
          <div ng-if="site.currentAction == 'pull' || 'push'" class="push-pull" ng-class="site.currentAction">
            <svg class="cloud-static" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" enable-background="new 0 0 100 100" xml:space="preserve"><path class="cloud-static-fill" fill-rule="evenodd" clip-rule="evenodd" d="M0.459,59.184c-0.693-15.077,14.074-24.961,25.259-20.155  c-0.892-11.649,7.097-18.909,18.089-20.643c9.496-1.499,17.488,3.687,21.674,12.396c9.281-11.316,30.533,0.967,21.792,15.494  c15.661,0.095,20.175,30.293-6.603,30.986H19.329c-10.422,0-18.87-9.272-18.87-17.559"/></svg>
            <i ng-if="site.currentAction == 'pull'" class="fa fa-3 fa-arrow-down arrow"></i>
            <i ng-if="site.currentAction == 'push'" class="fa fa-3 fa-arrow-up arrow"></i>
            <h2 class="loading" ng-bind="currentActionName()"></h2>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div ng-repeat="err in ui.errors">
    <div>
      {{err.message}}
    </div>
  </div>
</div>
